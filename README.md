# Modded Minecraft Block Mapping

This project maps modded Minecraft blocks to their closest vanilla Minecraft counterparts using cosine similarity in the text embedding space. By leveraging the `nomic-embed-text` model, it enables the use of schematic files containing modded blocks by converting them to vanilla blocks when loading the palette. This is particularly useful for compatibility with vanilla Minecraft environments.

Currently, the project includes **9,663 mappings** and continues to grow as more modded blocks are processed.

## Features
- Maps modded blocks to vanilla blocks using text embeddings and cosine similarity.
- Processes error logs from [mc-structure-processor](https://github.com/Kingburrito777/mc-structure-processor) to identify unknown modded blocks.
- Outputs mappings to a CSV file (`modded_block_map_full.csv`) for easy integration.
- Utilizes the `nomic-embed-text` model, which outperforms other embedding models like BERT for this task.

## Requirements
- Python 3.x
- `scikit-learn` (for cosine similarity calculations)
- `ollama` (to run the `nomic-embed-text` model locally)
- Error log file (`error_log_unknown_blocks.txt`) generated by [mc-structure-processor](https://github.com/Kingburrito777/mc-structure-processor)

## Installation
1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/modded-block-mapping.git
   cd modded-block-mapping
   ```
2. Install Python dependencies:
   ```bash
   pip install scikit-learn ollama
   ```
3. Set up Ollama and ensure the `nomic-embed-text` model is available:
   ```bash
   ollama pull nomic-embed-text
   ```
   Ensure the Ollama server is running locally at `http://localhost:11434`.

## Usage
1. Prepare the error log file (`error_log_unknown_blocks.txt`) containing unknown modded blocks, formatted as:
   ```
   Unknown block: swdm:siding_light_green_stairs
   Unknown block: swdm:roof_tile_lime_legacy
   ...
   ```
2. Run the script:
   ```bash
   python main.py
   ```
3. The script will:
   - Load vanilla blocks from `block_mapping/blocks.json`.
   - Extract modded blocks from the error log.
   - Compute embeddings using `nomic-embed-text`.
   - Map modded blocks to their nearest vanilla counterparts.
   - Save the mappings to `block_mapping/modded_block_map_full.csv`.

### Visualizing Block Embeddings
1. Run the t-SNE visualization script to create an interactive plot:
   ```bash
   python tsne_visualization.py
   ```
2. The script will:
   - Load the mappings from `block_mapping/modded_block_map_full.csv`.
   - Compute embeddings for modded and vanilla blocks.
   - Apply t-SNE to reduce embeddings to 2D.
   - Generate an interactive Plotly scatter plot saved as `visualizations/tsne_block_visualization.html`.

3. **Viewing Visualizations**:
   - **Interactive Plot**: View the interactive t-SNE visualization hosted on GitHub Pages at:
     [https://kingburrito777.github.io/mc-modded-block-mappings/tsne_block_visualization.html](https://kingburrito777.github.io/mc-modded-block-mappings/tsne_block_visualization.html)
     - Hover over points to see block names and explore the clustering of modded and vanilla blocks.
   - **Static Images**: Preview the t-SNE plots in the repository:
     - [`visualizations/example1.png`](./visualizations/example1.png): Shows clustering of modded and vanilla blocks.
     - [`visualizations/example2.png`](./visualizations/example2.png): Highlights embedding distributions.
   - **Accessing the HTML File Locally** (if GitHub Pages is unavailable):
     1. Navigate to [`visualizations/tsne_block_visualization.html`](./visualizations/tsne_block_visualization.html) in the repository.
     2. Click the **"Raw"** button at the top-right to access the raw HTML content.
     3. Copy the content and save it as an `.html` file locally (e.g., `tsne_block_visualization.html`).
     4. Open the saved file in a web browser to interact with the visualization.
     5. Alternatively, download the file directly from the repository and open it in a browser.

## Example Mappings
Below are some notable mappings from the generated CSV:

| Modded Block                          | Vanilla Block             |
|---------------------------------------|---------------------------|
| pixelmon:bauxite_ore                  | coal_ore                  |
| harvestcraft:salt                     | sand                      |
| ThermalFoundation:Ore                 | gold_ore                  |
| pixelmon:white_chair                  | white_bed                 |
| biomesoplenty:log_0                   | jungle_log                |
| biomesoplenty:fir_fence               | spruce_fence              |
| appliedenergistics2:quantum_ring      | bell                      |
| cocricotmod:condiment_ketchup         | kelp                      |
| victorymod:bug_jar                    | bee_nest                  |
| ktmod:server_rack_5                   | vault                     |

### Questionable Mappings
Due to complex or ambiguous modded block names, some mappings may be less accurate:

| Modded Block                          | Vanilla Block             |
|---------------------------------------|---------------------------|
| victorymod:paint_four_fifteen         | chiseled_nether_bricks    |
| victorymod:high_chair                 | tall_grass                |
| victorymod:backpack                   | jungle_log                |
| victorymod:rich_cup_one               | pumpkin                   |
| pfm:deepslate_tile_kitchen_counter_oven | deepslate_tile_stairs   |

## Limitations
- **Loss of Contextual Data**: Mapping modded blocks to vanilla blocks inherently reduces the block set, potentially losing unique properties of modded blocks.
- **Complex Names**: Modded blocks with highly specific or ambiguous names may result in suboptimal mappings.
- **Dependency on Error Logs**: The script relies on error logs from [mc-structure-processor](https://github.com/Kingburrito777/mc-structure-processor) to identify modded blocks.

## Why `nomic-embed-text`?
The `nomic-embed-text` model was chosen for its superior performance in capturing semantic relationships between block names compared to other models like BERT. Its embeddings provide more accurate cosine similarity results for this specific use case.

## Statics
![`visualizations/example1.png`](./visualizations/example1.png)
![`visualizations/example2.png`](./visualizations/example2.png)

## Contributing
Contributions are welcome! To contribute:
1. Fork the repository.
2. Create a new branch for your feature or bugfix.
3. Submit a pull request with a clear description of your changes.

Please ensure your changes are tested and include updates to the documentation if necessary.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Acknowledgments
- [mc-structure-processor](https://github.com/Kingburrito777/mc-structure-processor) for generating error logs.
- [Ollama](https://ollama.ai/) for providing an easy-to-use interface for text embeddings.
- The Minecraft modding community for creating the diverse blocks that inspired this project.
